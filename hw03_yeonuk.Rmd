---
title: "hw03: manipulate & explore data (dplyr, ggplot2)"
author: "Yeonuk"
date: "September 28, 2017"
output: github_document
---


##### Packages which I used
```{r}
suppressPackageStartupMessages(library(tidyverse)) 
suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(cowplot))
knitr::opts_chunk$set(fig.width=10, fig.height=7)

```


## Report my process

>
> I worked for **4 tasks** (1st, 2nd, 4th, and 6th tasks). I tried my best to analyze Gapminder data set. All the tasks include figures and tables.   
>
> *Please enjoy the results!!*
> 

## Homework

### Task 1: Get the maximum and minimum of GDP per capita for all continents. 

- See the table and boxplot. 

```{r}
# extract max and min of gdpPercap
T10 <- gapminder %>% group_by(continent) %>% 
  summarise(MAX = max(gdpPercap),MIN = min(gdpPercap)) 

# extract country and year which are with max and min of gdpPercap
T11 <- gapminder %>% filter(gdpPercap %in% T10$MAX) %>% 
  mutate(MAX_info = paste(country, year, sep=", ")) %>% select(continent, MAX_info) 
T12 <- gapminder %>% filter(gdpPercap %in% T10$MIN) %>% 
  mutate(MIN_info = paste(country, year, sep=", ")) %>% select(continent, MIN_info)

# rearrange by name of continent (alphabet)
T11 <- arrange(T11, continent) 
T12 <- arrange(T12, continent)

# merge data and make table
T1 <- data.frame(T10, MAX_info=T11$MAX_info, MIN_info=T12$MIN_info)
knitr::kable(T1)  

```

```{r}
#drawing boxplot with texts (country, year) on max and min points
P1 <- gapminder %>% ggplot(aes(continent, gdpPercap))
P1 + geom_boxplot(aes(fill=continent)) +
     geom_text(aes(label=ifelse(gdpPercap %in% c(T1$MAX,T1$MIN), 
                                paste(country,year,sep=", \n"),''), angle=5)) +
     scale_y_continuous(limits=c(-10000,120000)) +
     theme_light()+ labs(y="GDP per capita", title="GDP BoxPlot for each continent with max & min info")

```

### Task 2: Look at the spread of GDP per capita within the continents.
```{r}
T2 <- gapminder %>% group_by(continent) %>% 
                      summarize(MAX = max(gdpPercap), MIN = min(gdpPercap), 
                      MEAN = mean(gdpPercap), SD = sd(gdpPercap), 
                      Q1 = quantile(gdpPercap,probs=0.25), 
                      Q2 = quantile(gdpPercap,probs=0.5),
                      Q3 = quantile(gdpPercap,probs=0.75))
knitr::kable(T2)  
```

```{r, set(fig.height=12)}
p2 <- gapminder %>% ggplot(aes(gdpPercap)) 
      
p20 <- p2 + geom_freqpoly(aes(gdpPercap,..density..,colour=continent), binwidth = 1800) +
      labs(x="GDP per capita", title="GDP histogram for each continent") +theme_bw()
p21 <- p2 + theme_bw() + facet_wrap( ~ continent) + 
      geom_histogram(aes(gdpPercap,..density..), bins =65, colour="blue") +
      labs(x="GDP per capita") +theme_bw()

plot_grid(p20, p21, ncol = 1, nrow = 2)


```


### Task 4: How is life expectancy changing over time on different continents?
```{r}

```

### Task 6: Find countries with interesting stories. Open-ended and, therefore, hard. 
```{r}

```


